gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019 <- vos_2019 %>%
group_by(statcode_muni) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_muni <-
gemeentegrenzen %>%
left_join(mean_vos_2019, by = c('statcode' = 'statcode_muni'))
data_muni %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019, by = c('statcode' = 'statcode_corop'))
mean_vos_2019
landelijk_gemiddelde = mean(vos_2019$ll_lr_ratio, na.rm = T)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_muni <- vos_2019 %>%
group_by(statcode_muni) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_muni <-
gemeentegrenzen %>%
left_join(mean_vos_2019_muni, by = c('statcode' = 'statcode_muni'))
data_muni %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
theme_void()
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
theme_void()
ggplot(data_corop) +
geom_sf(aes(fill = perc_high_ll_lr_ratio)) +
labs(title = "Percentage scholen met bovengemiddelde leerling/leraar ratios (per gemeente)", fill = "") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
ggplot(data_corop) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
View(mean_vos_2019_corop)
colnames(vos_2019)
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
theme_void()
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = schooltype) +
theme_void()
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = schooltype) +
theme_void()
data_corop
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = schooltype) +
theme_void()
data_corop
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
left_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
data_corop <-
corop_grenzen %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
View(data_corop)
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(cols = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_corop <-
corop_grenzen %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
View(corop_grenzen)
cbind(corop_grenzen, 1)
cbind(corop_grenzen, data.frmae(schooltype = 1)
}
cbind(corop_grenzen, data.frmae(schooltype = 1)
cbind(corop_grenzen, data.frmae(schooltype = 1))
cbind(corop_grenzen, data.frame(schooltype = 1))
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
lapply(create_corop_with_school_type, unique(mean_vos_2019_corop$schooltype))
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type)
rbind(lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
do.call('rbind', lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
corop_grenzen_schooltype = do.call('rbind', lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
View(data_corop)
View(mean_vos_2019_corop)
mean_vos_2019_muni <- vos_2019 %>% filter(schooltype == 'vmbo/havo/vwo') %>%
group_by(statcode_muni) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
landelijk_gemiddelde = mean(vos_2019$ll_lr_ratio, na.rm = T)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_muni <- vos_2019 %>% filter(schooltype == 'vmbo/havo/vwo') %>%
group_by(statcode_muni) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
data_muni <-
gemeentegrenzen %>%
left_join(mean_vos_2019_muni, by = c('statcode' = 'statcode_muni'))
data_muni %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
corop_grenzen_schooltype = do.call('rbind', lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
#ggsave('vo_corop.pdf', p, height = 30, width = 15)
p
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
corop_grenzen_schooltype = do.call('rbind', lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
#ggsave('vo_corop.pdf', p, height = 30, width = 15)
p
library(sf)
corop_grenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_coropgebied_2019_gegeneraliseerd&outputFormat=json")
mean_vos_2019_corop<- vos_2019 %>%
group_by(statcode_corop, schooltype) %>%
summarise(
tot_onderwijzers = sum(onderwijzers),
tot_leerlingen = sum(leerlingen),
mean_school_size = mean(leerlingen),
mean_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T),
perc_high_ll_lr_ratio = sum(ll_lr_ratio > landelijk_gemiddelde, na.rm = T) / n()
) %>%
ungroup() %>%
mutate(
ll_lr_ratio_cut = cut(mean_ll_lr_ratio, breaks = quantile(mean_ll_lr_ratio))
)
create_corop_with_school_type = function(t) cbind(corop_grenzen, data.frame(schooltype = t))
corop_grenzen_schooltype = do.call('rbind', lapply(unique(mean_vos_2019_corop$schooltype), create_corop_with_school_type))
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype'))
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
#ggsave('vo_corop.pdf', p, height = 30, width = 15)
p
View(mean_vos_2019_corop)
vos = functiemix_school %>% filter(schooltype %in% c('vmbo', 'vmbo-t', 'vmbo-t/havo/vwo', 'vmbo/havo/vwo', 'havo/vwo'))
View(vos)
vos %>% filter(jaar == 2019)
vos_by_type = vos %>% group_by(schooltype, jaar) %>%
summarise(
tot_leerlingen = sum(leerlingen),
tot_onderwijzers = sum(onderwijzers),
tot_managers = sum(managers),
gem_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T)
)
vos_by_type = vos %>% group_by(schooltype, jaar) %>%
summarise(
tot_leerlingen = sum(leerlingen),
tot_onderwijzers = sum(onderwijzers),
tot_managers = sum(managers),
gem_ll_lr_ratio = mean(ll_lr_ratio, na.rm = T)
)
ggplot(vos_by_type, aes(x = jaar, y = tot_leerlingen, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
ggplot(vos_by_type, aes(x = jaar, y = gem_ll_lr_ratio, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
ggplot(vos_by_type, aes(x = jaar, y = tot_leerlingen, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
ggplot(vos_by_type, aes(x = jaar, y = tot_onderwijzers, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
ggplot(vos_by_type, aes(x = jaar, y = gem_ll_lr_ratio, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
p = ggplot(vos_by_type, aes(x = jaar, y = gem_ll_lr_ratio, group = schooltype, color = schooltype, fill = schooltype)) + geom_line()  +  theme_minimal()
ggsave('vo_tijdstrend.pdf', p)
ggsave('vo_tijdstrend.pdf', p, width = 7, height = 4)
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype')) %>%
filter(schooltype %in% 'vmbo/havo/vwo')
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
#ggsave('vo_corop.pdf', p, height = 30, width = 15)
p
ggsave('vo_corop.pdf', p, height = 30, width = 15)
data_corop <-
corop_grenzen_schooltype %>%
full_join(mean_vos_2019_corop, by = c('statcode' = 'statcode_corop', 'schooltype' = 'schooltype')) %>%
filter(schooltype %in% 'vmbo/havo/vwo')
p = data_corop %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per COROP regio)", fill = "") +
facet_grid(rows = vars(schooltype)) +
theme_void()
ggsave('vo_corop.pdf', p, height = 30, width = 15)
ggsave('vo_corop.pdf', p, height = 15, width = 15)
