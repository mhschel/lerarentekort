hist(baos_2019$gem_loonsom)
schaal_11_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers
)
ggplot(schaal_11_data, aes(percentage_11, gem_loonsom)) +
geom_bin2d()
schaal_11_12_data = baos_2019 %>% mutate(
percentage_11_12 = (schaal_11 + schaal_12) / onderwijzers
)
ggplot(schaal_11_12_data, aes(percentage_11_12, gem_loonsom)) +
geom_bin2d()
baos_2019_schoolgewicht = baos_2019  %>% mutate(
percentage_11_12 = (schaal_11 + schaal_12) / onderwijzers
)
ggplot(baos_2019_schoolgewicht, aes(schoolweging, gem_loonsom)) +
geom_bin2d()
summary(lm(data=baos_2019_schoolgewicht, gem_loonsom~schoolweging+percentage_11_12))
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
summary(lm(data=schaal_data, gem_loonsom~leeftijd))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11))
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d() + xlim(0,15000)
summary(lm(data=baos_2019 %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling))
summary(lm(data=schaal_data %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling+leeftijd+percentage_11_12))
summary(lm(data=baos_2019, gem_loonsom~oab))
summary(lm(data=schaal_data, gem_loonsom~oab+leeftijd+percentage_11_12))
salaris_model <- lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12)
schaal_data$gem_loonsom_verschil = schaal_data$gem_loonsom - predict(salaris_model, schaal_data)
hist(schaal_data$gem_loonsom_verschil)
summary(lm(data=schaal_data %>% mutate(vermogen_ll = vermogen / leerlingen), gem_loonsom_verschil~vermogen_ll))
hist(baos_2019$gem_loonsom)
schaal_11_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers
)
ggplot(schaal_11_data, aes(percentage_11, gem_loonsom)) +
geom_bin2d()
schaal_11_12_data = baos_2019 %>% mutate(
percentage_11_12 = (schaal_11 + schaal_12) / onderwijzers
)
ggplot(schaal_11_12_data, aes(percentage_11_12, gem_loonsom)) +
geom_bin2d()
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom),
vermogen_bestuur = mean(vermogen),
vermogen_leerling = sum(vermogen)/sum(leerlingen)
)
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_leerling, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, leraar_overschot_tekort_bestuur)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, totaal_loonsom)) +
geom_bin2d()
summary(lm(data=baos_2019_besturen, per_leraar_tekort~vermogen_bestuur))
ggplot(baos_2019_besturen, aes(, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom),
vermogen_bestuur = mean(vermogen),
vermogen_leerling = sum(vermogen)/sum(leerlingen)
)
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_leerling, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, leraar_overschot_tekort_bestuur)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, totaal_loonsom)) +
geom_bin2d()
summary(lm(data=baos_2019_besturen, per_leraar_tekort~vermogen_bestuur))
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
summary(lm(data=schaal_data, gem_loonsom~leeftijd))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11))
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d() + xlim(0,15000)
summary(lm(data=baos_2019 %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling))
summary(lm(data=schaal_data %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling+leeftijd+percentage_11_12))
summary(lm(data=baos_2019, gem_loonsom~oab))
summary(lm(data=schaal_data, gem_loonsom~oab+leeftijd+percentage_11_12))
salaris_model <- lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12)
schaal_data$gem_loonsom_verschil = schaal_data$gem_loonsom - predict(salaris_model, schaal_data)
hist(schaal_data$gem_loonsom_verschil)
summary(lm(data=schaal_data %>% mutate(vermogen_ll = vermogen / leerlingen), gem_loonsom_verschil~vermogen_ll))
ggplot(baos_jaar, aes(x = jaar, y = onderwijzers)) + geom_line() + theme_minimal()
?barplot
barplot(mean_baos_2019$mean_ll_lr_ratio)
barplot(mean_baos_2019$mean_ll_lr_ratio, names.org=statcode)
barplot(mean_baos_2019$mean_ll_lr_ratio, names.org="statcode")
gemeentegrenzen %>%
left_join(mean_baos_2019)
gemeente_ll_lr_ratio <-
gemeentegrenzen %>%
left_join(mean_baos_2019) %>% select(
statnaam, mean_ll_lr_ratio
)
barplot(gemeente_ll_lr_ratio)
gemeente_ll_lr_ratio <-
gemeentegrenzen %>%
left_join(mean_baos_2019) %>% select(
statnaam, mean_ll_lr_ratio
)
View(gemeente_ll_lr_ratio)
?sort
gemeente_ll_lr_ratio <-
gemeentegrenzen %>%
left_join(mean_baos_2019) %>% select(
statnaam, sort(mean_ll_lr_ratio)
)
gemeente_ll_lr_ratio <-
gemeentegrenzen %>%
left_join(mean_baos_2019) %>% select(
statnaam, mean_ll_lr_ratio
) %>% sort(mean_ll_lr_ratio)
gemeente_ll_lr_ratio <-
gemeentegrenzen %>%
left_join(mean_baos_2019) %>% select(
statnaam, mean_ll_lr_ratio
)
barplot(gemeente_ll_lr_ratio$mean_ll_lr_ratio, names.arg=gemeente_ll_lr_ratio$statnaam)
g4_data = data %>% select(
statnaam=c("Amsterdam", "Rotterdam", "Utrecht", "Den Haag")
)
g4_data = data %>% select(
statnaam %in% c("Amsterdam", "Rotterdam", "Utrecht", "Den Haag")
)
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
g5_data <- data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN,
schaal_10 = OMVANG_FORMATIE_OP_L10,
schaal_11 = OMVANG_FORMATIE_OP_L11,
schaal_12 = OMVANG_FORMATIE_OP_L12,
schaal_LA = OMVANG_FORMATIE_OP_LA,
schaal_LB = OMVANG_FORMATIE_OP_LB,
schaal_LC = OMVANG_FORMATIE_OP_LC
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
library(readxl)
schoolgewicht <- read_excel("../data_files/schoolweging-2017-2019.xlsx", sheet="Tabel 3") %>%
select(brin=`Tabel 3`, schoolweging= `...4`) %>% slice(-(1:4)) %>% mutate(schoolweging = as.numeric(schoolweging))
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen,
) %>% select(bevoegd_gezag, vermogen, Jaar)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE,
jaar = PEILJAAR
)
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, brin=BRINNUMMER) %>% summarise(
totaal_bekostiging = BEDRAG[BEKOSTIGINGSKENMERKEN == "TOTAAL"],
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERKEN == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERKEN == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar"))) %>% left_join(inkomsten_data, by=(c("jaar"="jaar", "brin"="brin")))
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = onderwijzers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_manager_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_support_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_manager_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_support_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_high_ll_lr_ratio)) +
labs(title = "% scholen met bovengemiddelde leerling/leraar ratios (per gemeente)") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio))
data %>% sort_means_table(sort_var = perc_high_ll_lr_ratio)
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN,
schaal_10 = OMVANG_FORMATIE_OP_L10,
schaal_11 = OMVANG_FORMATIE_OP_L11,
schaal_12 = OMVANG_FORMATIE_OP_L12,
schaal_LA = OMVANG_FORMATIE_OP_LA,
schaal_LB = OMVANG_FORMATIE_OP_LB,
schaal_LC = OMVANG_FORMATIE_OP_LC
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
library(readxl)
schoolgewicht <- read_excel("../data_files/schoolweging-2017-2019.xlsx", sheet="Tabel 3") %>%
select(brin=`Tabel 3`, schoolweging= `...4`) %>% slice(-(1:4)) %>% mutate(schoolweging = as.numeric(schoolweging))
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen,
) %>% select(bevoegd_gezag, vermogen, Jaar)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE,
jaar = PEILJAAR
)
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, brin=BRINNUMMER) %>% summarise(
totaal_bekostiging = BEDRAG[BEKOSTIGINGSKENMERKEN == "TOTAAL"],
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERKEN == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERKEN == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar"))) %>% left_join(inkomsten_data, by=(c("jaar"="jaar", "brin"="brin")))
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_manager_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_support_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_manager_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_support_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_high_ll_lr_ratio)) +
labs(title = "% scholen met bovengemiddelde leerling/leraar ratios (per gemeente)") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio))
data %>% sort_means_table(sort_var = perc_high_ll_lr_ratio)
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
g5_data <- data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
boxplot(g5_data$mean_ll_lr_ratio)
barplot(g5_data$mean_ll_lr_ratio)
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam)
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("green", "blue", "red", "yellow", "orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("green", "red", "dark green", "yellow", "orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("dark blue", "red", "dark green", "yellow", "orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("dark blue", "red", "dark green", "yellow", "orange"), plot.window(ylim=20))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("dark blue", "red", "dark green", "yellow", "orange"), plot.window(5,20))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("dark blue", "red", "dark green", "yellow", "orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col= 'Reds'))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col= 'Reds')
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col= (pallete ='Reds'))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("dark blue", "red", "dark green", "yellow", "orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "dark yellow", "orange", "dark orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "orange", "dark orange"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "dark orange", "red"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "dark orange", "red"), ylim=20)
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "dark orange", "red"), ylim= "20")
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "dark orange", "red"))
ggplot(baos_2019, aes(schoolweging, ll_lr_ratio)) +
geom_bin2d()
baos_2019_gewicht = baos_2019 %>% mutate(
gewicht_categorie = if(schooweging <25){ 1} else if(schoolweging >=25 && schoolweging < 30) {2} else if(schoolweging >=30 && schoolweging <35) {3} else if(schoolweging >= 35){4},
)
View(baos_2019)
class(baos_2019$schoolweging)
baos_2019_gewicht = baos_2019 %>% mutate(
gewicht_categorie = if(baos_2019$schooweging <25){ 1} else if(schoolweging >=25 && schoolweging < 30) {2} else if(schoolweging >=30 && schoolweging <35) {3} else if(schoolweging >= 35){4},
)
baos_2019_gewicht = baos_2019 %>% mutate(
gewicht_categorie = if(baos_2019$schooweging <25){ 1} else if(baos_2019$schooweging >=25 && baos_2019$schooweging < 30) {2} else if(baos_2019$schooweging >=30 && baos_2019$schooweging <35) {3} else if(baos_2019$schooweging >= 35){4},
)
baos_2019_gewicht = baos_2019 %>% mutate(
gewicht_categorie = if(baos_2019$schooweging <25){ gewicht_categorie = 1} else if(baos_2019$schooweging >=25 && baos_2019$schooweging < 30) {gewicht_categorie =2} else if(baos_2019$schooweging >=30 && baos_2019$schooweging <35) {gewicht_categorie =3} else if(baos_2019$schooweging >= 35){gewicht_categorie =4},
)
baos_2019_gewicht = baos_2019 %>% summarise(
mean_weging = mean(ll_lr_ratio[schoolweging < 25])
)
View(baos_2019_gewicht)
g5_data <- data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
barplot(g5_data$mean_ll_lr_ratio, names.arg = g5_data$statnaam, col=c("light yellow", "yellow", "orange", "dark orange", "red"))
baos_gewicht_categorie = baos_2019 %>% mutate(
gewicht_categorie = ifelse(schoolweging < 25, 1, no=ifelse(schoolweging>=25 && schoolweging <30, 2, no=(ifelse(schoolweging>=30 && schoolweging < 35, 3, 4))))
)
View(baos_gewicht_categorie)
baos_gewicht_categorie = baos_2019 %>% mutate(
gewicht_categorie = ifelse(schoolweging < 25, 1,
ifelse(schoolweging>=25 && schoolweging <30, 2,
ifelse(schoolweging>=30 && schoolweging < 35, 3, 4)))
)
baos_gewicht_categorie = baos_2019 %>% mutate(
gewicht_categorie = ifelse(schoolweging < 25, 1,
ifelse(schoolweging <30, 2,
ifelse(schoolweging < 35, 3, 4)))
)
baos_gewicht_categorie = baos_2019 %>% mutate(
gewicht_categorie = ifelse(schoolweging < 25, 1,
ifelse(schoolweging <30, 2,
ifelse(schoolweging < 35, 3, 4)))
) %>% group_by(gewicht_categorie) %>% summarise(
mean_categorie_ll_lr = mean(ll_lr_ratio)
)
barplot(baos_gewicht_categorie)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = c("Laag", "Lage midden", "Hoge midden", "Hoog")
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = c("Laag", "Lage midden", "Hoge midden", "Hoog")
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = c("Laag", "Lage midden", "Hoge midden", "Hoog"))
baos_gewicht_categorie = baos_2019 %>% mutate(
gewicht_categorie = ifelse(schoolweging < 25, "Laag",
ifelse(schoolweging <30, "Lage midden",
ifelse(schoolweging < 35, "Hoge midden", "Hoog")))
) %>% group_by(gewicht_categorie) %>% summarise(
mean_categorie_ll_lr = mean(ll_lr_ratio)
)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = baos_gewicht_categorie$gewicht_categorie)
hist(baos_gewicht_categorie$mean_categorie_ll_lr)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = baos_gewicht_categorie$gewicht_categorie)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = baos_gewicht_categorie$gewicht_categorie, axes=TRUE)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = baos_gewicht_categorie$gewicht_categorie, axes=FALSE)
barplot(baos_gewicht_categorie$mean_categorie_ll_lr, names.arg = baos_gewicht_categorie$gewicht_categorie)
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
barplot(g5_data$mean_ll_lr_ratio)
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio))
data %>% sort_means_table(sort_var = desc(mean_ll_lr_ratio))
