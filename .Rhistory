bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50)
baos_2019 = baos %>% filter(jaar == 2019)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>% summarise(nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers), leerlingen = sum(leerlingen), onderwijzers = sum(onderwijzers), schools = n())
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() +
coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() +
coord_cartesian(ylim = c(6000, 6500))
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_high_ll_lr_ratio)) +
labs(title = "% scholen met bovengemiddelde leerling/leraar ratios (per gemeente)") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio))
data %>% sort_means_table(sort_var = perc_high_ll_lr_ratio)
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
baos_2009 = baos %>% filter(jaar == 2009)
tot_2009 = baos_2009 %>% summarise(
tot_scholen = n(),
tot_leerlingen = sum(leerlingen),
gem_leerlingen = mean(leerlingen),
tot_onderwijzers = sum(onderwijzers),
gem_ll_lr_ratio = mean(ll_lr_ratio),
tot_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers)
)
head(tot_2009)
View(baos_2019)
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen), onderwijzers = sum(onderwijzers),
schools = n()
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
View(baos_2019)
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
schools = n(),
)
ggplot(baos_jaar, aes(x = jaar, y = managers)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = managers / n())) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = managers / schools)) + geom_line() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
)
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = managers / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = managers / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / schools)) + geom_line() + theme_minimal()
View(functiemix_school)
functiemix_school = read_csv('data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen
)
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / schools)) + geom_line() + theme_minimal()
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers)
)
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
e
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / schools)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = managers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = ondersteunend_personeel / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = managers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers_op_salaris)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers_op_salaris)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50)
baos_2019 = baos %>% filter(jaar == 2019)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ll_manager_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ll_manager_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
library(tekortindicator)
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50)
baos_2019 = baos %>% filter(jaar == 2019)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ll_manager_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ll_support_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
library(tekortindicator)
ggplot(data) +
geom_sf(aes(fill = ll_manager_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
functiemix_school = left_join(functiemix_school, adres_bao)
statcode_from_gm_nummer = function(x) if(is.finite(x)) paste0('GM', paste(rep('0', 4-nchar(x)), collapse = ''), x) else NA
functiemix_school$statcode = sapply(functiemix_school$statcode, statcode_from_gm_nummer)
table(functiemix_school$statcode)[1:5]
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50)
baos_2019 = baos %>% filter(jaar == 2019)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_jaar = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>%
group_by(jaar) %>%
summarise(
nat_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers),
leerlingen = sum(leerlingen),
onderwijzers = sum(onderwijzers),
managers = sum(managers),
ondersteunend_personeel = sum(ondersteunend_personeel),
schools = n(),
medewerkers = sum(medewerkers),
medewerkers_op_salaris = sum(medewerkers_op_salaris)
)
ggplot(baos_jaar, aes(x = jaar, y = nat_ll_lr_ratio)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(16, 20))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = schools)) + geom_line() + theme_minimal() + coord_cartesian(ylim = c(6000, 6500))
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers / leerlingen)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = medewerkers_op_salaris / medewerkers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / medewerkers)) + geom_line() + theme_minimal()
mean_baos_2019 <- baos_2019 %>%
summarize_schools_by_loc(loc=statcode)
head(mean_baos_2019)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(mean_baos_2019)
data %>%
ggplot() +
geom_sf(aes(fill = mean_ll_lr_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Leraar Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_manager_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_support_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ll_support_ratio)) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_manager_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_support_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_manager_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_support_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / managers)) + geom_line() + theme_minimal()
ggplot(baos_jaar, aes(x = jaar, y = leerlingen / ondersteunend_personeel)) + geom_line() + theme_minimal()
