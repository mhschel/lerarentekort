theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_manager_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Directeur Ratio (per gemeente)", fill = "") +
theme_void()
data %>%
ggplot() +
geom_sf(aes(fill = ntile(ll_support_ratio, 100))) +
scale_fill_viridis_c() +
labs(title = "Gemiddelde Leerling/Ondersteunend Personeel Ratio (per gemeente)", fill = "") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_high_ll_lr_ratio)) +
labs(title = "% scholen met bovengemiddelde leerling/leraar ratios (per gemeente)") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = ll_lr_ratio_cut)) +
labs(title = "ll_lr_ratio_cut", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio))
data %>% sort_means_table(sort_var = perc_high_ll_lr_ratio)
data %>% sort_means_table(sort_var = desc(perc_high_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
baos_2009 = baos %>% filter(jaar == 2009)
tot_2009 = baos_2009 %>% summarise(
tot_scholen = n(),
tot_leerlingen = sum(leerlingen),
gem_leerlingen = mean(leerlingen),
tot_onderwijzers = sum(onderwijzers),
gem_ll_lr_ratio = mean(ll_lr_ratio),
tot_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers)
)
head(tot_2009)
tot_2019 = baos_2019 %>% summarise(
tot_scholen = n(),
tot_leerlingen = sum(leerlingen),
gem_leerlingen = mean(leerlingen),
tot_onderwijzers = sum(onderwijzers),
gem_ll_lr_ratio = mean(ll_lr_ratio),
tot_ll_lr_ratio = sum(leerlingen) / sum(onderwijzers)
)
head(tot_2019)
round(unlist(tot_2019) / unlist(tot_2009), 2)
mean_baos_2009 <- baos_2009 %>%
tekortindicator::summarize_schools_by_loc(loc=statcode)
mean_baos_joined = join_means_tables(mean_baos_2009, mean_baos_2019)
data <-
gemeentegrenzen %>%
left_join(mean_baos_joined)
ggplot(data) +
geom_sf(aes(fill = change_ll_lr_ratio_cut)) +
labs(title = "Verandering Leerling-leraar ratio 2009-2019 (per gemeente)", fill = "") +
scale_fill_brewer(palette = 'Reds') +
theme_void()
data %>% sort_changes_table(sort_var = desc(change_ll_lr_ratio)) %>%
filter(statnaam %in% c('Amsterdam', 'Utrecht', 'Eindhoven', 'Rotterdam', "'s-Gravenhage"))
data %>% sort_changes_table(sort_var = desc(change_ll_lr_ratio))
data %>% sort_changes_table(sort_var = change_ll_lr_ratio)
landelijk_gemiddelde = sum(mean_baos_2019$tot_leerlingen) / sum(mean_baos_2019$tot_onderwijzers)
herverdeling_data = mean_baos_2019 %>% mutate(
gem_ll_lr_ratio = tot_leerlingen / tot_onderwijzers,
diff_landelijk = gem_ll_lr_ratio - landelijk_gemiddelde,
leraar_overschot_tekort = tot_onderwijzers - (tot_leerlingen / landelijk_gemiddelde),
leraar_overschot_tekort_cut = cut(leraar_overschot_tekort, breaks = c(-Inf, 0, Inf), labels = c('Tekort', 'Overschot')),
perc_leraar_overschot_tekort = (leraar_overschot_tekort / tot_onderwijzers) * 100
)
data <-
gemeentegrenzen %>%
left_join(herverdeling_data)
ggplot(data) +
geom_sf(aes(fill = leraar_overschot_tekort)) +
labs(title = "Leraar Overschot / Tekort (per gemeente)", fill = "") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = leraar_overschot_tekort_cut)) +
labs(title = "Overschot / Tekort (per gemeente)", fill = "") +
scale_fill_discrete(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_leraar_overschot_tekort)) +
labs(title = "% Onderwijzers Overschot / Tekort (per gemeente)", fill = "") +
scale_fill_continuous(type = "viridis") +
theme_void()
data %>% as_tibble() %>%
select(statnaam, tot_leerlingen, gem_ll_lr_ratio, leraar_overschot_tekort, perc_leraar_overschot_tekort) %>%
arrange((leraar_overschot_tekort))
data %>% as_tibble() %>%
select(statnaam, tot_leerlingen, gem_ll_lr_ratio, leraar_overschot_tekort, perc_leraar_overschot_tekort) %>%
arrange(desc(leraar_overschot_tekort))
data %>% as_tibble() %>%
select(statnaam, tot_leerlingen, gem_ll_lr_ratio, leraar_overschot_tekort, perc_leraar_overschot_tekort) %>%
arrange((perc_leraar_overschot_tekort))
data %>% as_tibble() %>%
select(statnaam, tot_leerlingen, gem_ll_lr_ratio, leraar_overschot_tekort, perc_leraar_overschot_tekort) %>%
arrange(desc(perc_leraar_overschot_tekort))
ggplot(data, aes(x = leraar_overschot_tekort, binwidth = 20)) + geom_histogram() + theme_minimal()
summary(data$perc_leraar_overschot_tekort)
lokale_herverdeling_data = baos_2019 %>%
group_by(statcode) %>% mutate(
diff_gemeente = ll_lr_ratio - (sum(leerlingen) / sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers))),
perc_leraar_overschot_tekort = (leraar_overschot_tekort / onderwijzers) * 100
) %>% summarise(
fte_verplaatsing = sum(leraar_overschot_tekort[leraar_overschot_tekort > 0]),
perc_fte_verplaatsing = fte_verplaatsing / sum(onderwijzers)
)
data <-
gemeentegrenzen %>%
left_join(lokale_herverdeling_data)
ggplot(data) +
geom_sf(aes(fill = fte_verplaatsing)) +
labs(title = "Aantal FTE verplaatst voor gelijke verdeling (per gemeente)", fill = "") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data) +
geom_sf(aes(fill = perc_fte_verplaatsing)) +
labs(title = "% van FTE verplaatst voor gelijke verdeling (per gemeente)", fill = "") +
scale_fill_continuous(type = "viridis") +
theme_void()
ggplot(data, aes(x = perc_fte_verplaatsing)) + geom_histogram(bins = 20) + theme_minimal()
data %>% as_tibble() %>%
select(statnaam, fte_verplaatsing, perc_fte_verplaatsing) %>%
arrange(desc(fte_verplaatsing))
data %>% as_tibble() %>%
select(statnaam, fte_verplaatsing, perc_fte_verplaatsing) %>%
arrange(desc(perc_fte_verplaatsing))
baos_2018 = baos %>% filter(jaar == 2018 & perc_gewicht > 0)
ggplot(baos_2018, aes(x = perc_gewicht, y = ll_lr_ratio)) + geom_point() + stat_smooth(method='lm') + theme_minimal()
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(gemeente_lonen_2019)
View(gemeente_lonen_2019)
gemeente_lonen_2019 = baos_2019 %>%
group_by(statcode) %>% summarise(
totaal_loonsom = sum(loonsom),
totaal_onderwijzers = sum(onderwijzers),
gemiddeld_loonsom = totaal_loonsom / totaal_onderwijzers,
)
summary(lm(data=gemeente_lonen_2019, gemiddeld_loonsom~randstad))
gemeente_lonen_2019 = baos_2019 %>%
group_by(statcode) %>% summarise(
totaal_loonsom = sum(loonsom),
totaal_onderwijzers = sum(onderwijzers),
gemiddeld_loonsom = totaal_loonsom / totaal_onderwijzers,
)
baos_2014 = baos %>% filter(jaar==2014)
gemeente_lonen_2014 = baos_2014 %>%
group_by(statcode) %>% mutate(
totaal_loonsom = sum(loonsom),
totaal_onderwijzers = sum(onderwijzers),
gemiddeld_loonsom = totaal_loonsom / totaal_onderwijzers,
)
library(sf)
gemeentegrenzen <- st_read("https://geodata.nationaalgeoregister.nl/cbsgebiedsindelingen/wfs?request=GetFeature&service=WFS&version=2.0.0&typeName=cbs_gemeente_2019_gegeneraliseerd&outputFormat=json")
data <-
gemeentegrenzen %>%
left_join(gemeente_lonen_2019)
data %>%
ggplot() +
geom_sf(aes(fill = gemiddeld_loonsom)) +
scale_fill_viridis_c(limits=c(2700, 4000)) +
labs(title = "Gemiddelde Loonsom 2019 (per gemeente)", fill = "") +
theme_void()
data <-
gemeentegrenzen %>%
left_join(gemeente_lonen_2014)
data %>%
ggplot() +
geom_sf(aes(fill = gemiddeld_loonsom)) +
scale_fill_viridis_c(limits=c(2700, 4000)) +
labs(title = "Gemiddelde Loonsom 2014 (per gemeente)", fill = "") +
theme_void()
baos_2019_besturen <- baos_2019 %>% left_join(brinnummers_po)%>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(gezag_no) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom)
) %>% left_join(balans_overzicht)
ggplot(baos_2019_besturen, aes(vermogen, totaal_loonsom)) +
geom_bin2d()
View(functiemix_school)
library(tidyverse)
library(tekortindicator)
adres_bao = read_csv('../data_files/adres_bao.csv') %>% select(
brin = `BRIN NUMMER`,
pc6 = POSTCODE,
statcode = GEMEENTENUMMER
)
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv')
View(functiemix_school)
read.csv(.../"Gemid_leeftijd.csv", sep=";")
read.csv(".../Gemid_leeftijd.csv", sep=";")
read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=";")
read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=",")
table(leeftijd_data$SCHOOLKENMERKEN)
leeftijd_data <- read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=","
table(leeftijd_data$SCHOOLKENMERKEN)
table(leeftijd_data$SCHOOLKENMERKEN)
leeftijd_data <- read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=","
)
table(leeftijd_data$SCHOOLKENMERKEN)
leeftijd_data <- read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=",") %>% summarise(
brin = BRINNUMMER,
leeftijd = WAARDE
)
leeftijd_data <- read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=",") %> % select(
brin = BRINNUMMER,
leeftijd = WAARDE
)
leeftijd_data <- read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=",") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE
)
View(leeftijd_data)
read.csv("/Users/anne-licnossen/Documents/Min Financiën/R. projects/tekortindicator/Gemid_leeftijd.csv", sep=","
balans_overzicht <- read_excel("../01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
read_excel("../01-balans-2015-2019.xlsx")
View(baos_2019)
read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO")
?left_join
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
functiemix_school = read_csv('../data_files/functiemix-instellingen.csv') %>% select(
jaar = JAAR,
brin = BRIN_NUMMER,
naam_school = INSTELLINGSNAAM,
gemeente = GEMEENTENAAM,
bevoegd_gezag = BEVOEGD_GEZAGNUMMER,
ll_lr_ratio = LEERLING_LERAAR_RATIO,
schooltype = SCHOOLTYPE,
medewerkers = OMVANG_FORMATIE_TOTAAL,
managers = OMVANG_FORMATIE_MANAGER,
ondersteunend_personeel = OMVANG_FORMATIE_OOP_OBP,
onderwijzers = OMVANG_FORMATIE_OP,
medewerkers_op_salaris = OMVANG_FORMATIE_OP_BRUTSAL,
loonsom = LOONSOM_OP_BRUTSAL,
gem_loonsom = GEMIDDELDE_LOONSOM_OP_BRUTSAL,
leerlingen = AANTAL_LEERLINGEN,
loc_randstad = RANDSTAD,
gewicht_ll = AANTAL_GEWICHTLEERLINGEN,
schaal_10 = OMVANG_FORMATIE_OP_L10,
schaal_11 = OMVANG_FORMATIE_OP_L11,
schaal_12 = OMVANG_FORMATIE_OP_L12,
schaal_LA = OMVANG_FORMATIE_OP_LA,
schaal_LB = OMVANG_FORMATIE_OP_LB,
schaal_LC = OMVANG_FORMATIE_OP_LC
) %>% mutate(
perc_gewicht = gewicht_ll / leerlingen,
gewogen_ll_lr_ratio = gewicht_ll / onderwijzers
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
View(baos)
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
select(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
)
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
select(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
)
read_excel("../data_files/01-balans-2015-2019.xlsx")
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
)
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
) %>% select(bevoegd_gezag, vermogen)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen
) %>% select(bevoegd_gezag, vermogen, Jaar)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar")))
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE
)
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht) %>% left_join(leeftijd_data)
table(baos_2019$brin)
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht) # %>% left_join(leeftijd_data)
table(baos_2019$brin)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN = "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE
)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar")))
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE
jaar = JAAR
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE,
jaar = JAAR
)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE,
jaar = PEILJAAR
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar")))
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(gezag_no) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom)
)
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom)
)
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom)
)
ggplot(baos_2019_besturen, aes(vermogen, per_leraar_tekort)) +
geom_bin2d()
library(readxl)
schoolgewicht <- read_excel("../data_files/schoolweging-2017-2019.xlsx", sheet="Tabel 3") %>%
select(brin=`Tabel 3`, schoolweging= `...4`) %>% slice(-(1:4)) %>% mutate(schoolweging = as.numeric(schoolweging))
balans_overzicht <- read_excel("../data_files/01-balans-2015-2019.xlsx") %>% filter(Sector == "PO") %>%
mutate(
bevoegd_gezag = as.numeric(Bevoegd_Gezag),
vermogen = Eigen_vermogen,
) %>% select(bevoegd_gezag, vermogen, Jaar)
leeftijd_data <- read.csv("../data_files/Gemid_leeftijd.csv", sep=",") %>% filter(SCHOOLKENMERKEN == "GEMIDDELDE_GEWOGEN_LEEFTIJD") %>% select(
brin = BRINNUMMER,
leeftijd = WAARDE,
jaar = PEILJAAR
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar")))
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom),
vermogen_bestuur = mean(vermogen)
)
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, leraar_overschot_tekort_bestuur)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, totaal_loonsom)) +
geom_bin2d()
baos_2019_besturen <- baos_2019 %>%
mutate(
diff_nl = ll_lr_ratio - (sum(leerlingen)/ sum(onderwijzers)),
leraar_overschot_tekort = onderwijzers - (leerlingen / (sum(leerlingen) / sum(onderwijzers)))
) %>% group_by(bevoegd_gezag) %>% summarise(
per_leraar_tekort = (sum(leraar_overschot_tekort) / sum(onderwijzers)) *100,
leraar_overschot_tekort_bestuur = sum(leraar_overschot_tekort),
totaal_loonsom = mean(gem_loonsom),
vermogen_bestuur = mean(vermogen),
vermogen_leerling = sum(vermogen)/sum(leerlingen)
)
ggplot(baos_2019_besturen, aes(vermogen_leerling, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_leerling, per_leraar_tekort)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, leraar_overschot_tekort_bestuur)) +
geom_bin2d()
ggplot(baos_2019_besturen, aes(vermogen_bestuur, totaal_loonsom)) +
geom_bin2d()
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
summary(lm(data=baos_schaaldata, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11))
summary(lm(data=schaal_data, gem_loonsom~leeftijd))
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
summary(lm(data=schaal_data, gem_loonsom~leeftijd))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11))
read.csv("../data_files/inkomsten_po.csv", sep=",")
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(PEILJAAR, BRINNUMMER) %>% summarise(
totaal_bekostiging = TOTAAL,
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERK == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERK == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"],
)
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, BRINNUMMER) %>% summarise(
totaal_bekostiging = TOTAAL,
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERK == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERK == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
k
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, BRINNUMMER) %>% summarise(
totaal_bekostiging = BEDRAG[BEKOSTIGINGSKENMERK == "TOTAAL"],
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERK == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERK == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
read.csv("../data_files/inkomsten_po.csv", sep=",")
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, BRINNUMMER) %>% summarise(
totaal_bekostiging = BEDRAG[BEKOSTIGINGSKENMERKEN == "TOTAAL"],
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERKEN == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERKEN == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
View(inkomsten_data)
inkomsten_data <- read.csv("../data_files/inkomsten_po.csv", sep=",") %>% group_by(jaar=PEILJAAR, brin=BRINNUMMER) %>% summarise(
totaal_bekostiging = BEDRAG[BEKOSTIGINGSKENMERKEN == "TOTAAL"],
kleine_schooltoeslag = BEDRAG[BEKOSTIGINGSKENMERKEN == "KLEINE_SCHOLEN_TOESLAG"],
oab = BEDRAG[BEKOSTIGINGSKENMERKEN == "BESTRIJDING_ONDERWIJSACHTERSTANDEN"]
)
baos = functiemix_school %>% filter(schooltype == 'bao' & ll_lr_ratio > 5 & ll_lr_ratio < 50) %>% left_join(balans_overzicht, by=(c("bevoegd_gezag" = "bevoegd_gezag", "jaar" = "Jaar"))) %>% left_join(leeftijd_data, by=(c('brin' = "brin", "jaar"="jaar"))) %>% left_join(inkomsten_data, by=(c("jaar"="jaar", "brin"="brin")))
baos_2019 = baos %>% filter(jaar == 2019) %>% left_join(schoolgewicht)
ggplot(baos_2019, aes(x = ll_lr_ratio)) + geom_histogram() + theme_minimal()
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d()
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d() + xlim(0,15000)
summary(lm(data=baos_2019, gem_loonsom~(totaal_bekostiging / leerlingen)))
summary(lm(data=baos_2019 %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling))
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d() + xlim(0,15000)
8.908e-03*5000
summary(lm(data=baos_2019 %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling+leeftijd))
summary(lm(data=schaal_data %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling+leeftijd+percentage_11_12))
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
schaal_data = baos_2019 %>% mutate(
percentage_11 = schaal_11 / onderwijzers,
percentage_11_12 = (schaal_11 + schaal_12)/ onderwijzers
)
ggplot(baos_2019, aes(leeftijd, gem_loonsom)) +
geom_bin2d()
summary(lm(data=schaal_data, gem_loonsom~leeftijd))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12))
summary(lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11))
ggplot(baos_2019, aes((totaal_bekostiging / leerlingen), gem_loonsom)) +
geom_bin2d() + xlim(0,15000)
summary(lm(data=baos_2019 %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling))
summary(lm(data=schaal_data %>% mutate(totaal_leerling = totaal_bekostiging / leerlingen), gem_loonsom~totaal_leerling+leeftijd+percentage_11_12))
summary(lm(data=baos_2019, gem_loonsom~oab))
summary(lm(data=schaal_data, gem_loonsom~oab+leeftijd+percentage_11_12))
salaris_model <- lm(data=baos_2019, gem_loonsom~leeftijd+percentage_11_12)
salaris_model <- lm(data=schaal_data, gem_loonsom~leeftijd+percentage_11_12)
predict(salaris_model, schaal_data)
schaal_data$gem_loonsom_verschil = schaal_data$gem_loonsom - predict(salaris_model, schaal_data)
hist(schaal_data$gem_loonsom_verschil)
summary(lm(data=schaal_data, gem_loonsom~gem_loonsom_verschil))
summary(lm(data=schaal_data, gem_loonsom_verschil~schoolgewicht))
summary(lm(data=schaal_data, gem_loonsom_verschil~schoolweging))
summary(lm(data=schaal_data, gem_loonsom_verschil~vermogen))
summary(lm(data=schaal_data %>% mutate(vermogen_ll = vermogen / leerlingen), gem_loonsom_verschil~vermogen_ll)
summary(lm(data=schaal_data %>% mutate(vermogen_ll = vermogen / leerlingen), gem_loonsom_verschil~vermogen_ll))
summary(lm(data=schaal_data %>% mutate(vermogen_ll = vermogen / leerlingen), gem_loonsom_verschil~vermogen_ll))
